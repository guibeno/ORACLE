Insert into MUSICA_PLAYLIST (ID,NOME,DESCRICAO,USER_ID,PLAYLIST_CURTIR,IMAGEM,IMAGEM_HASH) values ('75','Músicas curtidas','Suas músicas curtidas','22','1',null,null);
Insert into MUSICA_PLAYLIST (ID,NOME,DESCRICAO,USER_ID,PLAYLIST_CURTIR,IMAGEM,IMAGEM_HASH) values ('93','Playlist Rap','Playlist Rap','1','0',null,null);
Insert into MUSICA_PLAYLIST (ID,NOME,DESCRICAO,USER_ID,PLAYLIST_CURTIR,IMAGEM,IMAGEM_HASH) values ('77','edu','edu1','24','0',null,null);
Insert into MUSICA_PLAYLIST (ID,NOME,DESCRICAO,USER_ID,PLAYLIST_CURTIR,IMAGEM,IMAGEM_HASH) values ('76','Teste','insano','22','0','https://tfavf9hmcaamd4yg.public.blob.vercel-storage.com/315e121e-fddd-4919-ba8d-461823fbdb5b.jpg','ae0ab3ae0b8ec1983d5e8f52414f04d0e599d56abbf0208de2978dd6436bfeae');
select * from musica_musicasalva;
select * from musica_playlist;
select * from musica_musicasalva_playlists;

INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (477, 511, 1); 
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (480, 515, 22);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (494, 516, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (515, 517, 22);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (524, 518, 24);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (527, 519, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (528, 520, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (532, 521, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (533, 522, 22);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (540, 523, 22);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (541, 532, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (542, 533, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (543, 534, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (544, 535, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (545, 536, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (546, 537, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (547, 538, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (549, 563, 22);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (550, 564, 24);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (551, 565, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (552, 566, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (566, 567, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (229, 568, 1);
INSERT INTO musica_musicasalva_playlists (ID, MUSICA_ID, USER_ID) VALUES (230, 569, 1);

-- Novas playlists criadas por usuários diferentes
INSERT INTO MUSICA_PLAYLIST (ID, NOME, DESCRICAO, USER_ID) VALUES (94, 'Rock Anos 80', 'Clássicos do rock dos anos 80', 2);
INSERT INTO MUSICA_PLAYLIST (ID, NOME, DESCRICAO, USER_ID) VALUES (95, 'Eletrônica', 'Batidas para animar o dia', 3);
INSERT INTO MUSICA_PLAYLIST (ID, NOME, DESCRICAO, USER_ID) VALUES (96, 'MPB', 'Música Popular Brasileira', 4);
INSERT INTO MUSICA_PLAYLIST (ID, NOME, DESCRICAO, USER_ID) VALUES (97, 'Sertanejo Raiz', 'Os clássicos do sertanejo', 5);
INSERT INTO MUSICA_PLAYLIST (ID, NOME, DESCRICAO, USER_ID) VALUES (98, 'Trap Hits', 'Os melhores do trap atual', 1);

-- Novas relações entre músicas salvas e playlists existentes
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (249, 567, 94);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (250, 568, 94);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (251, 569, 95);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (252, 570, 96);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (253, 571, 97);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (254, 572, 95);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (255, 573, 96);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (256, 574, 98);



INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (232, 527, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (233, 528, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (234, 540, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (240, 546, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (241, 547, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (217, 477, 75);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (223, 515, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (214, 477, 76);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (239, 545, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (231, 524, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (213, 480, 76);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (229, 532, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (244, 543, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (245, 551, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (246, 552, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (230, 494, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (235, 533, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (236, 541, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (237, 542, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (238, 544, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (242, 549, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (243, 550, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (248, 566, 93);


INSERT INTO MUSICA_PLAYLIST (ID, NOME, DESCRICAO, USER_ID) VALUES (75, 'Músicas curtidas', 'Suas músicas curtidas', 22);
INSERT INTO MUSICA_PLAYLIST (ID, NOME, DESCRICAO, USER_ID) VALUES (93, 'Playlist Rap', 'Playlist Rap', 1);
INSERT INTO MUSICA_PLAYLIST (ID, NOME, DESCRICAO, USER_ID) VALUES (77, 'edu', 'edu1', 24);
INSERT INTO MUSICA_PLAYLIST (ID, NOME, DESCRICAO, USER_ID) VALUES (76, 'Teste', 'insano', 22);

-- Reutilizando músicas com playlists de user_ids diferentes
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (249, 527, 75); -- já estava na 93
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (250, 528, 76);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (251, 540, 77);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (252, 546, 76);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (253, 547, 75);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (254, 515, 76); -- já estava na 93
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (255, 480, 75); -- já estava na 76
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (256, 532, 75);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (257, 533, 77);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (258, 541, 77);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (259, 542, 77);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (260, 543, 76);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (261, 549, 75);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (262, 550, 75);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (263, 566, 75);

-- Criando algumas novas combinações com MUSICASALVA_ID acima de 580
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (264, 580, 75);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (265, 581, 75);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (266, 582, 75);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (267, 583, 76);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (268, 584, 76);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (269, 585, 76);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (270, 586, 77);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (271, 587, 77);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (272, 588, 77);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (273, 589, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (274, 590, 93);
INSERT INTO MUSICA_MUSICASALVA_PLAYLISTS (ID, MUSICASALVA_ID, PLAYLIST_ID) VALUES (275, 591, 93);



CREATE OR REPLACE PROCEDURE listas_musica_mais_salva
    contador_menor = 0
    loop 
        select count(m.musicasalva_id) into contador
        from musica_musicasalva_playlists m
        where m.musicasalva_id = m.musicasalva_id
        
        if contador > contador_menor
            contador_menor = contador
            select nome into nome_musica
            from musica_musicasalva
            where id = m.musicasalva_id
    end loop
            
        dbms.outputline(musica mais adicionada em playslit 1 nome_musica
        dbms.outputline(musica mais adicionada em playslit 2 nome_musica
        fazer isso ate 15
        
        
select * from musica_musicasalva;
select * from musica_playlist;
select * from musica_musicasalva_playlists;

CREATE OR REPLACE PROCEDURE listas_musica_mais_salva1 IS
  -- cursor para pegar as 15 músicas mais salvas
  CURSOR c_top_musicas IS
    SELECT m.musica_id, COUNT(*) AS total
    FROM musica_musicasalva_playlists m
    GROUP BY m.musica_id
    ORDER BY total DESC
    FETCH FIRST 15 ROWS ONLY;

  nome_musica VARCHAR2(255);
  contador INTEGER := 0;
BEGIN
  FOR rec IN c_top_musicas LOOP
    -- pegar o nome da musica na tabela musica_musicasalva
    SELECT nome INTO nome_musica FROM musica_musicasalva WHERE id = rec.musica_id;

    contador := contador + 1;
    DBMS_OUTPUT.PUT_LINE('Musica mais adicionada em playlist ' || contador || ': ' || nome_musica || ' (salva ' || rec.total || ' vezes)');
  END LOOP;
END;



